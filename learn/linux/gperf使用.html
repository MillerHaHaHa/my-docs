<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>gperftools 使用 | Miller の 文档库</title><meta name="description" content="记录各种折腾笔记">
    <link rel="preload" href="/my-docs/assets/style-C3ozQjM4.css" as="style"><link rel="stylesheet" href="/my-docs/assets/style-C3ozQjM4.css">
    <link rel="modulepreload" href="/my-docs/assets/app-CmOngkEL.js"><link rel="modulepreload" href="/my-docs/assets/gperf使用.html-CEigzXgx.js">
    <link rel="prefetch" href="/my-docs/assets/index.html-BT7fGLJ6.js" as="script"><link rel="prefetch" href="/my-docs/assets/get-started.html-DWX_LKOq.js" as="script"><link rel="prefetch" href="/my-docs/assets/文档库介绍.html-Dyk3CpVa.js" as="script"><link rel="prefetch" href="/my-docs/assets/windows激活.html-BMwKohCD.js" as="script"><link rel="prefetch" href="/my-docs/assets/linux开发常用bashrc配置.html-DtYFgNpS.js" as="script"><link rel="prefetch" href="/my-docs/assets/nfs安装和使用.html-8_KLrofJ.js" as="script"><link rel="prefetch" href="/my-docs/assets/nginx安装和使用.html-BHGB15Nv.js" as="script"><link rel="prefetch" href="/my-docs/assets/nodejs安装和使用.html-C1q96xfg.js" as="script"><link rel="prefetch" href="/my-docs/assets/tc流控.html-B0o0X6Bi.js" as="script"><link rel="prefetch" href="/my-docs/assets/ufw使用.html-A3titfpf.js" as="script"><link rel="prefetch" href="/my-docs/assets/docker搭建nextcloud.html-DVZ8KRH4.js" as="script"><link rel="prefetch" href="/my-docs/assets/nextcloud安装和使用.html-U941YX_X.js" as="script"><link rel="prefetch" href="/my-docs/assets/qbittorrent使用.html-Bx4myX-E.js" as="script"><link rel="prefetch" href="/my-docs/assets/ssh多次登录失败加入黑名单.html-wU98LdvU.js" as="script"><link rel="prefetch" href="/my-docs/assets/IPC名词.html-D_cScuu6.js" as="script"><link rel="prefetch" href="/my-docs/assets/UART1的使用.html-C9HDhq_e.js" as="script"><link rel="prefetch" href="/my-docs/assets/coredump调试.html-DWKbmY3L.js" as="script"><link rel="prefetch" href="/my-docs/assets/fw_printfenv使用.html-B5dc2nNf.js" as="script"><link rel="prefetch" href="/my-docs/assets/lvgl调试.html-Bf38EUAi.js" as="script"><link rel="prefetch" href="/my-docs/assets/sdiowifi驱动适配.html-obwj1axR.js" as="script"><link rel="prefetch" href="/my-docs/assets/快速修改内核配置.html-C-u8Oovg.js" as="script"><link rel="prefetch" href="/my-docs/assets/板子配置.html-CxBZFhyi.js" as="script"><link rel="prefetch" href="/my-docs/assets/板端常用命令.html-DXhp3qRR.js" as="script"><link rel="prefetch" href="/my-docs/assets/设置登录密码.html-DNakUgb9.js" as="script"><link rel="prefetch" href="/my-docs/assets/配置USB网卡.html-B3jVfnFp.js" as="script"><link rel="prefetch" href="/my-docs/assets/配置USB虚拟U盘.html-DUhFwJr_.js" as="script"><link rel="prefetch" href="/my-docs/assets/404.html-DqrPH7_w.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/my-docs/"><img class="logo" src="https://images-1306478114.cos.ap-guangzhou.myqcloud.com/%E4%B9%A6%E6%9E%B6%E9%80%89%E4%B8%AD.svg" alt="Miller の 文档库"><span class="site-name can-hide" aria-hidden="true">Miller の 文档库</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习"><span class="title">学习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习"><span class="title">学习</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Common</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/common/windows%E6%BF%80%E6%B4%BB.html" aria-label="windows 激活"><!--[--><!--[--><!--]--> windows 激活 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Linux</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/linux%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8bashrc%E9%85%8D%E7%BD%AE.html" aria-label="linux 开发常用 bashrc 配置"><!--[--><!--[--><!--]--> linux 开发常用 bashrc 配置 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/my-docs/learn/linux/gperf%E4%BD%BF%E7%94%A8.html" aria-label="gperftools 使用"><!--[--><!--[--><!--]--> gperftools 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nfs%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nfs 安装和使用"><!--[--><!--[--><!--]--> nfs 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nginx%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nginx 安装和使用"><!--[--><!--[--><!--]--> nginx 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nodejs%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nodejs 安装和使用"><!--[--><!--[--><!--]--> nodejs 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/tc%E6%B5%81%E6%8E%A7.html" aria-label="tc 流控"><!--[--><!--[--><!--]--> tc 流控 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/ufw%E4%BD%BF%E7%94%A8.html" aria-label="ufw 使用"><!--[--><!--[--><!--]--> ufw 使用 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Nas</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/docker%E6%90%AD%E5%BB%BAnextcloud.html" aria-label="docker 搭建 nextcloud"><!--[--><!--[--><!--]--> docker 搭建 nextcloud <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/nextcloud%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nextcloud 安装和使用"><!--[--><!--[--><!--]--> nextcloud 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/qbittorrent%E4%BD%BF%E7%94%A8.html" aria-label="qbittorrent 使用"><!--[--><!--[--><!--]--> qbittorrent 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/ssh%E5%A4%9A%E6%AC%A1%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5%E5%8A%A0%E5%85%A5%E9%BB%91%E5%90%8D%E5%8D%95.html" aria-label="ssh 多次登录失败加入黑名单"><!--[--><!--[--><!--]--> ssh 多次登录失败加入黑名单 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工作"><span class="title">工作</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工作"><span class="title">工作</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Goke</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/coredump%E8%B0%83%E8%AF%95.html" aria-label="core dump 调试"><!--[--><!--[--><!--]--> core dump 调试 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/fw_printfenv%E4%BD%BF%E7%94%A8.html" aria-label="fw_printfenv 使用"><!--[--><!--[--><!--]--> fw_printfenv 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/IPC%E5%90%8D%E8%AF%8D.html" aria-label="IPC 名词"><!--[--><!--[--><!--]--> IPC 名词 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/lvgl%E8%B0%83%E8%AF%95.html" aria-label="lvgl 调试"><!--[--><!--[--><!--]--> lvgl 调试 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/sdiowifi%E9%A9%B1%E5%8A%A8%E9%80%82%E9%85%8D.html" aria-label="sdio wifi 驱动适配"><!--[--><!--[--><!--]--> sdio wifi 驱动适配 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/UART1%E7%9A%84%E4%BD%BF%E7%94%A8.html" aria-label="UART1 的使用"><!--[--><!--[--><!--]--> UART1 的使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E5%BF%AB%E9%80%9F%E4%BF%AE%E6%94%B9%E5%86%85%E6%A0%B8%E9%85%8D%E7%BD%AE.html" aria-label="快速修改内核配置"><!--[--><!--[--><!--]--> 快速修改内核配置 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html" aria-label="/work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html"><!--[--><!--[--><!--]--> /work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E6%9D%BF%E7%AB%AF%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" aria-label="板端常用命令"><!--[--><!--[--><!--]--> 板端常用命令 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E8%AE%BE%E7%BD%AE%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81.html" aria-label="设置登录密码"><!--[--><!--[--><!--]--> 设置登录密码 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E9%85%8D%E7%BD%AEUSB%E7%BD%91%E5%8D%A1.html" aria-label="如何使用 USB 网卡"><!--[--><!--[--><!--]--> 如何使用 USB 网卡 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E9%85%8D%E7%BD%AEUSB%E8%99%9A%E6%8B%9FU%E7%9B%98.html" aria-label="配置 USB 虚拟 U 盘"><!--[--><!--[--><!--]--> 配置 USB 虚拟 U 盘 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习"><span class="title">学习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习"><span class="title">学习</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Common</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/common/windows%E6%BF%80%E6%B4%BB.html" aria-label="windows 激活"><!--[--><!--[--><!--]--> windows 激活 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Linux</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/linux%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8bashrc%E9%85%8D%E7%BD%AE.html" aria-label="linux 开发常用 bashrc 配置"><!--[--><!--[--><!--]--> linux 开发常用 bashrc 配置 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/my-docs/learn/linux/gperf%E4%BD%BF%E7%94%A8.html" aria-label="gperftools 使用"><!--[--><!--[--><!--]--> gperftools 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nfs%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nfs 安装和使用"><!--[--><!--[--><!--]--> nfs 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nginx%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nginx 安装和使用"><!--[--><!--[--><!--]--> nginx 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/nodejs%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nodejs 安装和使用"><!--[--><!--[--><!--]--> nodejs 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/tc%E6%B5%81%E6%8E%A7.html" aria-label="tc 流控"><!--[--><!--[--><!--]--> tc 流控 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/linux/ufw%E4%BD%BF%E7%94%A8.html" aria-label="ufw 使用"><!--[--><!--[--><!--]--> ufw 使用 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Nas</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/docker%E6%90%AD%E5%BB%BAnextcloud.html" aria-label="docker 搭建 nextcloud"><!--[--><!--[--><!--]--> docker 搭建 nextcloud <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/nextcloud%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" aria-label="nextcloud 安装和使用"><!--[--><!--[--><!--]--> nextcloud 安装和使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/qbittorrent%E4%BD%BF%E7%94%A8.html" aria-label="qbittorrent 使用"><!--[--><!--[--><!--]--> qbittorrent 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/learn/nas/ssh%E5%A4%9A%E6%AC%A1%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5%E5%8A%A0%E5%85%A5%E9%BB%91%E5%90%8D%E5%8D%95.html" aria-label="ssh 多次登录失败加入黑名单"><!--[--><!--[--><!--]--> ssh 多次登录失败加入黑名单 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工作"><span class="title">工作</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工作"><span class="title">工作</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Goke</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/coredump%E8%B0%83%E8%AF%95.html" aria-label="core dump 调试"><!--[--><!--[--><!--]--> core dump 调试 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/fw_printfenv%E4%BD%BF%E7%94%A8.html" aria-label="fw_printfenv 使用"><!--[--><!--[--><!--]--> fw_printfenv 使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/IPC%E5%90%8D%E8%AF%8D.html" aria-label="IPC 名词"><!--[--><!--[--><!--]--> IPC 名词 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/lvgl%E8%B0%83%E8%AF%95.html" aria-label="lvgl 调试"><!--[--><!--[--><!--]--> lvgl 调试 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/sdiowifi%E9%A9%B1%E5%8A%A8%E9%80%82%E9%85%8D.html" aria-label="sdio wifi 驱动适配"><!--[--><!--[--><!--]--> sdio wifi 驱动适配 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/UART1%E7%9A%84%E4%BD%BF%E7%94%A8.html" aria-label="UART1 的使用"><!--[--><!--[--><!--]--> UART1 的使用 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E5%BF%AB%E9%80%9F%E4%BF%AE%E6%94%B9%E5%86%85%E6%A0%B8%E9%85%8D%E7%BD%AE.html" aria-label="快速修改内核配置"><!--[--><!--[--><!--]--> 快速修改内核配置 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html" aria-label="/work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html"><!--[--><!--[--><!--]--> /work/goke/%E6%9D%BF%E5%AD%90%E9%85%8D%E7%BD%AE.html <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E6%9D%BF%E7%AB%AF%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" aria-label="板端常用命令"><!--[--><!--[--><!--]--> 板端常用命令 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E8%AE%BE%E7%BD%AE%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81.html" aria-label="设置登录密码"><!--[--><!--[--><!--]--> 设置登录密码 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E9%85%8D%E7%BD%AEUSB%E7%BD%91%E5%8D%A1.html" aria-label="如何使用 USB 网卡"><!--[--><!--[--><!--]--> 如何使用 USB 网卡 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/my-docs/work/goke/%E9%85%8D%E7%BD%AEUSB%E8%99%9A%E6%8B%9FU%E7%9B%98.html" aria-label="配置 USB 虚拟 U 盘"><!--[--><!--[--><!--]--> 配置 USB 虚拟 U 盘 <!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">gperftools 使用 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#内存检测" aria-label="内存检测"><!--[--><!--[--><!--]--> 内存检测 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_1、使用方法-预加载方式" aria-label="1、使用方法 - 预加载方式"><!--[--><!--[--><!--]--> 1、使用方法 - 预加载方式 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2、使用方法-头文件方式" aria-label="2、使用方法 - 头文件方式"><!--[--><!--[--><!--]--> 2、使用方法 - 头文件方式 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2、生成分析报告" aria-label="2、生成分析报告"><!--[--><!--[--><!--]--> 2、生成分析报告 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#_2-1-heap-profiler" aria-label="2.1 heap profiler"><!--[--><!--[--><!--]--> 2.1 heap profiler <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2-2-profiler" aria-label="2.2 profiler"><!--[--><!--[--><!--]--> 2.2 profiler <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#_3、安装" aria-label="3、安装"><!--[--><!--[--><!--]--> 3、安装 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_4、交叉编译" aria-label="4、交叉编译"><!--[--><!--[--><!--]--> 4、交叉编译 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_5、常见问题" aria-label="5、常见问题"><!--[--><!--[--><!--]--> 5、常见问题 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#signal-handler-27-被占用" aria-label="signal handler 27 被占用"><!--[--><!--[--><!--]--> signal handler 27 被占用 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#跟踪堆" aria-label="跟踪堆"><!--[--><!--[--><!--]--> 跟踪堆 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#_6、参考链接" aria-label="6、参考链接"><!--[--><!--[--><!--]--> 6、参考链接 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="gperftools-使用" tabindex="-1"><a class="header-anchor" href="#gperftools-使用"><span>gperftools 使用</span></a></h1><h2 id="内存检测" tabindex="-1"><a class="header-anchor" href="#内存检测"><span>内存检测</span></a></h2><h2 id="_1、使用方法-预加载方式" tabindex="-1"><a class="header-anchor" href="#_1、使用方法-预加载方式"><span>1、使用方法 - 预加载方式</span></a></h2><p><strong>链接库</strong></p><div class="language-makefile line-numbers-mode" data-ext="makefile" data-title="makefile"><pre class="language-makefile"><code>-ltcmalloc_and_profiler
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>添加环境变量</strong></p><p><strong>内存用量检测</strong></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>export HEAPPROFILE=linux_out.hprof
export HEAPPROFILESIGNAL=12
export HEAP_PROFILE_ALLOCATION_INTERVAL=524288
export LD_PRELOAD=/system/lib/libtcmalloc.so
/system/bin/app_main -f /system/config/config.json -d /userdata/device &amp;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>内存泄漏检测</strong></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>HEAPCHECK=normal LD_PRELOAD=&quot;/system/lib/libtcmalloc.so&quot; ./build_linux/linux_out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>运行程序</strong></p><p><strong>生成报告</strong></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>killall -12 linux_out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_2、使用方法-头文件方式" tabindex="-1"><a class="header-anchor" href="#_2、使用方法-头文件方式"><span>2、使用方法 - 头文件方式</span></a></h2><p><strong>包含头文件</strong></p><div class="language-c_cpp line-numbers-mode" data-ext="c_cpp" data-title="c_cpp"><pre class="language-c_cpp"><code>#include &lt;gperftools/heap-profiler.h&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>调用函数</strong></p><p>开始调用</p><div class="language-c_cpp line-numbers-mode" data-ext="c_cpp" data-title="c_cpp"><pre class="language-c_cpp"><code>int HeapProfilerStart(const char* fname); // fname是***.heap文件的前缀
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>结束调用</strong></p><div class="language-c_cpp line-numbers-mode" data-ext="c_cpp" data-title="c_cpp"><pre class="language-c_cpp"><code>void HeapProfilerDump(const char* reason);
void HeapProfilerStop();
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>链接库</strong></p><div class="language-makefile line-numbers-mode" data-ext="makefile" data-title="makefile"><pre class="language-makefile"><code>-ltcmalloc_and_profiler
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>运行程序</strong></p><p>可以设置堆内存使用多大，生成一个片段 524288 512k</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token assign-left variable">HEAP_PROFILE_ALLOCATION_INTERVAL</span><span class="token operator">=</span><span class="token number">10485760</span>  ./bin/kvsWebrtcClientMaster
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>结束程序，生成 heap</strong></p><br><h2 id="_2、生成分析报告" tabindex="-1"><a class="header-anchor" href="#_2、生成分析报告"><span>2、生成分析报告</span></a></h2><h3 id="_2-1-heap-profiler" tabindex="-1"><a class="header-anchor" href="#_2-1-heap-profiler"><span>2.1 heap profiler</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pprof <span class="token parameter variable">--pdf</span> <span class="token parameter variable">--lines</span> <span class="token parameter variable">--heapcheck</span> <span class="token parameter variable">--alloc_space</span> build_linux/linux_out linux_out.hprof.0001.heap <span class="token operator">&gt;</span> out.pdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pprof <span class="token parameter variable">--pdf</span> <span class="token parameter variable">--inuse_objects</span> <span class="token parameter variable">--lines</span> <span class="token parameter variable">--heapcheck</span>  <span class="token parameter variable">--edgefraction</span><span class="token operator">=</span>1e-10 <span class="token parameter variable">--nodefraction</span><span class="token operator">=</span>1e-10 build_linux/linux_out linux_out.heap.0001.heap <span class="token operator">&gt;</span> out.pdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pprof  ./bin/kvsWebrtcClientMaster ./gmem/test.log.0001.heap <span class="token operator">&gt;</span> out.pdf  <span class="token parameter variable">--lines</span>   <span class="token parameter variable">--inuse_objects</span> <span class="token parameter variable">--heapcheck</span> <span class="token parameter variable">--pdf</span> <span class="token parameter variable">--inuse_objects</span> <span class="token parameter variable">--lines</span> <span class="token parameter variable">--heapcheck</span>  <span class="token parameter variable">--edgefraction</span><span class="token operator">=</span>1e-10 <span class="token parameter variable">--nodefraction</span><span class="token operator">=</span>1e-10 <span class="token parameter variable">--text</span> <span class="token parameter variable">--cum</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>分析模式</p><p>--inuse_space Display the number of in-use megabytes (i.e. space that has been allocated but not freed). This is the default. --inuse_objects Display the number of in-use objects (i.e. number of objects that have been allocated but not freed). --alloc_space Display the number of allocated megabytes. This includes the space that has since been de-allocated. Use this if you want to find the main allocation sites in the program. --alloc_objects Display the number of allocated objects. This includes the objects that have since been de-allocated. Use this if you want to find the main allocation sites in the program.</p></blockquote><p>官网生成</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>pprof ./test &quot;/tmp/test.3362._main_-end.heap&quot; --inuse_objects --lines --heapcheck  --edgefraction=1e-10 --nodefraction=1e-10 --pdf &gt; out.pdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>交叉报告</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>pprof ~/project/1016_ipc_application_fw_m219e/output/rootfs/system/bin/app_main m219e.0001.heap --lib_prefix ~/project/1016_ipc_application_fw_m219e/output/rootfs --inuse_objects --lines --heapcheck --edgefraction=1e-10 --nodefraction=1e-10 --pdf &gt; leak.pdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-2-profiler" tabindex="-1"><a class="header-anchor" href="#_2-2-profiler"><span>2.2 profiler</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pprof <span class="token parameter variable">--pdf</span> build_linux/linux_out linux_out.prof <span class="token operator">&gt;</span> out.pdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pprof <span class="token parameter variable">--text</span> <span class="token parameter variable">--lines</span> build_linux/linux_out linux_out.prof <span class="token operator">&gt;</span> out.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><br><h2 id="_3、安装" tabindex="-1"><a class="header-anchor" href="#_3、安装"><span>3、安装</span></a></h2><p>安装 libunwind： <code>sudo apt install libunwind-dev</code></p><p>安装 gperftools：下载源码，<code>./configure &amp; make &amp; sudo make install</code></p><br><h2 id="_4、交叉编译" tabindex="-1"><a class="header-anchor" href="#_4、交叉编译"><span>4、交叉编译</span></a></h2><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>export PATH=$PATH:/opt/mips-gcc540-glibc222-64bit-r3.3.0/bin
export CC=mips-linux-uclibc-gnu-gcc
export CXX=mips-linux-uclibc-gnu-g++
export AR=mips-linux-uclibc-gnu-ar
export RANLIB=mips-linux-uclibc-gnu-ranlib
export LD=mips-linux-uclibc-gnu-ld
./autogen.sh
./configure --prefix=/home/miller/project/gperftools/output/m219e --host=mips-linux
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h2 id="_5、常见问题" tabindex="-1"><a class="header-anchor" href="#_5、常见问题"><span>5、常见问题</span></a></h2><h3 id="signal-handler-27-被占用" tabindex="-1"><a class="header-anchor" href="#signal-handler-27-被占用"><span>signal handler 27 被占用</span></a></h3><p>其他调试工具，例如 gprof 占用了，去掉编译选项 -pd</p><br><h3 id="跟踪堆" tabindex="-1"><a class="header-anchor" href="#跟踪堆"><span>跟踪堆</span></a></h3><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>#if USE_GPEFTOOL
#include &lt;gperftools/malloc_extension_c.h&gt;
#endif

int GetHeapSize() 
{
    #if USE_GPEFTOOL
    size_t heap_size;
    if (MallocExtension_GetNumericProperty(&quot;generic.heap_size&quot;, &amp;heap_size)) {
        XLOG_WARN(&quot;Heap size: %lu\n&quot;, heap_size);
    } else {
        XLOG_ERROR(&quot;Failed to get heap size.\n&quot;);
    }
    #endif
    return 0;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h2 id="_6、参考链接" tabindex="-1"><a class="header-anchor" href="#_6、参考链接"><span>6、参考链接</span></a></h2><p><a href="https://gperftools.github.io/gperftools/" target="_blank" rel="noopener noreferrer">gperftools 官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: huangmingle@goke.com">huangmingle</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/my-docs/assets/app-CmOngkEL.js" defer></script>
  </body>
</html>
